
<!doctype html>

<html>
<head>
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <meta name="theme-color" content="#4F7DC9">
  <meta charset="UTF-8">
  <title>50è¡Œpythonä»£ç æ‹¯æ•‘&#34;æ‡’ç™Œ&#34;</title>
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro:400|Roboto:400,300,400italic,500,700|Roboto+Mono">
  <link rel="stylesheet" href="//fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://storage.googleapis.com/codelab-elements/codelab-elements.css">
  <style>
    .success {
      color: #1e8e3e;
    }
    .error {
      color: red;
    }
  </style>
</head>
<body>
  <google-codelab-analytics gaid="UA-49880327-14"></google-codelab-analytics>
  <google-codelab title="50è¡Œpythonä»£ç æ‹¯æ•‘&#34;æ‡’ç™Œ&#34;"
                  environment="web"
                  feedback-link="http://www.sctu.edu.cn">
    
      <google-codelab-step label="å¥‡å¦™çš„å·¥å…·" duration="0">
        <p>åˆšåˆšå¼€å§‹å­¦pythonçš„æ—¶å€™ï¼Œè€å¸ˆå°±è¯´ç°ä»£æŠ€æœ¯çš„å‘å±•æœ€ç»ˆç›®çš„å°±æ˜¯ä¸ºäº†æ–¹ä¾¿ï¼Œè¯´ç™½äº†ï¼Œå°±æ˜¯å¤§å®¶éƒ½&#34;æ‡’&#34;ï¼Œ æ‡’å¾—ä»€ä¹ˆäº‹æƒ…éƒ½äº²åŠ›äº²ä¸ºï¼Œå¦‚æœæœ‰å·¥å…·èƒ½å¸®åŠ©æˆ‘ä»¬åšäº‹ï¼Œå²‚ä¸å¦™å“‰ï¼Ÿ</p>
<p><img src="img/61ac68670c662718.png"></p>
<p>è€Œç°ä»£æ–‡æ˜çš„äº§ç‰©â€”â€”ç”µè„‘ï¼Œå°±å¯ä»¥æ›¿ä»£æˆ‘ä»¬äººåšå¾ˆå¤šäº‹æƒ…ã€‚è€Œåœ¨ä¼—å¤šçš„ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œå°¤å…¶ä¸èƒ½æ”¾è¿‡Pythonè¿™ä¸ªå°å¦–ç²¾ï¼<br>çºµè§‚å››æµ·ï¼Œç¬”è€…ç»ˆäºæ‰¾åˆ°äº†ä¸€ç»„å¯ä»¥ç›´æ¥åˆ©ç”¨å¾®ä¿¡æ§åˆ¶ç”µè„‘å…³æœºçš„ä»£ç ï¼ï¼ˆä¸ºå•¥æˆ‘è‡ªå·±å†™ä¸å‡ºæ¥å‘¢ï¼Ÿå› ä¸ºâ€˜ç¨‹åºè®¾è®¡ï¼Œèœæ˜¯åŸç½ª&#39;ğŸ¶ï¼‰</p>


      </google-codelab-step>
    
      <google-codelab-step label="ç”¨åˆ°çš„åº“" duration="0">
        <h2>åˆ©ç”¨cmdï¼Œä¸‹è½½3ä¸ªç¬¬ä¸‰æ–¹åº“ï¼šitchatã€opencvã€matplotlib</h2>
<p>ä¸‹è½½å‘½ä»¤ï¼špip install + åº“å</p>
<p><img src="img/5926f2ce3da404ed.png"></p>
<p>ç”¨åŒæ ·çš„æ–¹å¼ä¸‹è½½å…¶ä»–çš„åº“ã€‚ç”¨pip listæ£€æŸ¥ç¬¬ä¸‰æ–¹åº“æ˜¯å¦å®‰è£…æˆåŠŸã€‚</p>
<p><img src="img/902a129e7d9b054b.png"></p>


      </google-codelab-step>
    
      <google-codelab-step label="å…¨éƒ¨ä»£ç " duration="0">
        <pre><code>#ä½œè€…ï¼šç—´æµ·
#é“¾æ¥ï¼šhttps://zhuanlan.zhihu.com/p/47676417
#æ¥æºï¼šçŸ¥ä¹
#è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚

import itchat
import os
import time
import cv2

sendMsg = u&#34;{æ¶ˆæ¯åŠ©æ‰‹}ï¼šæš‚æ—¶æ— æ³•å›å¤&#34;
usageMsg = u&#34;ä½¿ç”¨æ–¹æ³•ï¼š\n1.è¿è¡ŒCMDå‘½ä»¤ï¼šcmd xxx (xxxä¸ºå‘½ä»¤)\n&#34; \
           u&#34;-ä¾‹å¦‚å…³æœºå‘½ä»¤:\ncmd shutdown -s -t 0 \n&#34; \
           u&#34;2.è·å–å½“å‰ç”µè„‘ç”¨æˆ·ï¼šcap\n3.å¯ç”¨æ¶ˆæ¯åŠ©æ‰‹(é»˜è®¤å…³é—­)ï¼šast\n&#34; \
           u&#34;4.å…³é—­æ¶ˆæ¯åŠ©æ‰‹ï¼šastc&#34;
flag = 0 #æ¶ˆæ¯åŠ©æ‰‹å¼€å…³
nowTime = time.localtime()
filename = str(nowTime.tm_mday)+str(nowTime.tm_hour)+str(nowTime.tm_min)+str(nowTime.tm_sec)+&#34;.txt&#34;
myfile = open(filename, &#39;w&#39;)

@itchat.msg_register(&#39;Text&#39;)
def text_reply(msg):
    global flag
    message = msg[&#39;Text&#39;]
    fromName = msg[&#39;FromUserName&#39;]
    toName = msg[&#39;ToUserName&#39;]

    if toName == &#34;filehelper&#34;:
        if message == &#34;cap&#34;:
            cap = cv2.VideoCapture(0)
            ret, img = cap.read()
            cv2.imwrite(&#34;weixinTemp.jpg&#34;, img)
            itchat.send(&#39;@img@%s&#39;%u&#39;weixinTemp.jpg&#39;, &#39;filehelper&#39;)
            cap.release()
        if message[0:3] == &#34;cmd&#34;:
            os.system(message.strip(message[0:4]))
        if message == &#34;ast&#34;:
            flag = 1
            itchat.send(&#34;æ¶ˆæ¯åŠ©æ‰‹å·²å¼€å¯&#34;, &#34;filehelper&#34;)
        if message == &#34;astc&#34;:
            flag = 0
            itchat.send(&#34;æ¶ˆæ¯åŠ©æ‰‹å·²å…³é—­&#34;, &#34;filehelper&#34;)
    elif flag == 1:
        itchat.send(sendMsg, fromName)
        myfile.write(message)
        myfile.write(&#34;\n&#34;)
        myfile.flush()

if __name__ == &#39;__main__&#39;:
    itchat.auto_login()
    itchat.send(usageMsg, &#34;filehelper&#34;)
    itchat.run()


</code></pre>


      </google-codelab-step>
    
      <google-codelab-step label="è¿è¡Œæ•ˆæœ" duration="0">
        <p>ç‚¹å‡»F5è¿è¡Œï¼Œä¼šå‡ºç°ä¸€ä¸ªå¾®ä¿¡ç™»å½•çš„éªŒè¯äºŒç»´ç </p>
<p><img src="img/238cb1cedb50aac3.png"></p>
<p>ç”¨å¾®ä¿¡æ‰«æï¼Œç™»å½•å³å¯ã€‚</p>
<p><img src="img/a7c16026e9dfbd2a.png"></p>
<p><img src="img/bf98447449d7a2b4.png"></p>
<p>éšåï¼Œå¾®ä¿¡æ–‡ä»¶åŠ©æ‰‹å°±ä¼šå‘é€è¿™æ ·çš„å¯¹è¯æ¡†</p>
<p>ä¹‹åå°±å¯ä»¥å®ç°è¿œç¨‹æ“ä½œè¾£ï¼ï¼æ¯”å¦‚å½“ä½ é€‰æ‹©äº†&#34;ç¡çœ æ¨¡å¼&#34;ï¼Œä½†æ˜¯è¿‡äº†ä¸€æ®µæ—¶é—´ä½ è¦ç¡è§‰äº†ï¼Œä¸ç”¨ç”µè„‘éœ€è¦å…³æœºçš„æ—¶å€™ï¼Œä½ å°±å¯ä»¥ç”¨å¾®ä¿¡å®ç°è¿œç¨‹æ“ä½œäº†ï¼</p>


      </google-codelab-step>
    
  </google-codelab>

  <script src="https://storage.googleapis.com/codelab-elements/native-shim.js"></script>
  <script src="https://storage.googleapis.com/codelab-elements/custom-elements.min.js"></script>
  <script src="https://storage.googleapis.com/codelab-elements/prettify.js"></script>
  <script src="https://storage.googleapis.com/codelab-elements/codelab-elements.js"></script>

</body>
</html>
