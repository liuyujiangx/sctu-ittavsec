
<!doctype html>

<html>
<head>
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <meta name="theme-color" content="#4F7DC9">
  <meta charset="UTF-8">
  <title>基于RGB颜色特征的火焰识别</title>
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro:400|Roboto:400,300,400italic,500,700|Roboto+Mono">
  <link rel="stylesheet" href="//fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://storage.googleapis.com/codelab-elements/codelab-elements.css">
  <style>
    .success {
      color: #1e8e3e;
    }
    .error {
      color: red;
    }
  </style>
</head>
<body>
  <google-codelab-analytics gaid="UA-49880327-14"></google-codelab-analytics>
  <google-codelab title="基于RGB颜色特征的火焰识别"
                  environment="web"
                  feedback-link="http://www.sctu.edu.cn">
    
      <google-codelab-step label="问题提出及分析" duration="0">
        <p>在计算机中图片一般用数组储存，以像素点为单位。</p>
<pre><code>import cv2 as cv
import numpy as np
src=cv.imread(&#34;img/3.jpg&#34;)
print(src.shape)#返回（高、宽、通道数）
print(src.size)#返回像素点个数
</code></pre>
<p>在RGB颜色空间下，每个像素点的颜色由R、G、B三通道组成，RGB颜色空间以R(Red红)、G(Green绿)、B(Blue蓝)三种基本色为基础,进行不同程度的叠加,产生丰富而广泛的颜色,所以也叫三基色模式。每个通道的取值范围从0到255，每种颜色都有对应的RGB值。</p>
<p>火焰也是如此，只要找到火焰颜色的RGB值的规律，就可以借此来识别图中的火焰。那么如何找到火焰的RGB值规律呢？</p>


      </google-codelab-step>
    
      <google-codelab-step label="问题解决" duration="0">
        <p>最简单的方法当然是统计学中的抽样调查啦，找几张只有火焰的图，读取它们的RGB值，并从中找出规律。也可以参考他人所写的相关文章，直接借用别人的数据。如图1<br></p>
<pre><code>#计算机中像素点RGB值在数组中存储的顺序是B、G、R
b=0
g=0
r=0
for i in range(len(src)):
    for j in range(len(src[i])):
        b += src[i][j][0]
        g += src[i][j][1]
        r += src[i][j][2]
#三通道均值
b_=b/src.size
g_=g/src.size
r_=r/src.size
print(&#34;b、g、r三通道均值分别为{}、{}、{}&#34;.format(b_,g_,r_))
#b、g、r三通道均值分别为5、33、74
</code></pre>


      </google-codelab-step>
    
      <google-codelab-step label="分析" duration="0">
        <p>除了RGB的取值范围存在规律之外，RGB三者的值之间也存在关系，这里直接为大家提供一些数据作为参考。</p>
<p>火焰RGB均值取值范围：R=217、G=109、B=78<br></p>
<p>$$<br>R(x,y)&gt;G(x,y)&gt;B(x,y)</p>
<p>$$</p>
<p>$$<br>R<em>m=\frac{1}{K}\sum</em>{i=1}^k R(x_i,y_i)<br>$$</p>
<p>RGB模型下提取疑似火焰区域<br></p>
<p><br>上式子中R(x，y),G(x，y),B(x，y)表示该像素点三种颜色的通道值，Rmon表示R通道的平均值， K代表总像素点数。</p>
<p>疑似火焰区域的关系式：<br></p>
<p>$$<br>r=R/(R+G+B) ,g=G/(R+G+B),b=B/(R+G+B)<br>$$</p>
<p>$$<br>r \geq 1.14g-0.076<br>$$</p>
<p>$$<br>r \leq -0.989g-0.991<br>$$</p>
<p>$$<br>r \geq -2.077g-1.025<br>$$</p>
<p>$$<br>r \leq -1.881b-0.9582<br>$$</p>
<p>$$<br>r \leq 95.348b-0.171<br>$$</p>
<p>$$<br>r \geq -0.543b-0.506<br>$$</p>
<p>$$<br>g \geq 0.846b-0.048<br>$$</p>
<p>$$<br>g \leq 0.461b-0.495<br>$$</p>
<p>$$<br>g \leq191.957b-0.621<br>$$</p>
<p>将上述公式作为条件，可以大致提取疑似火焰区域<br></p>
<p><br>效果图：<br></p>
<pre><code>#代码
import cv2 as cv
import numpy as np
src=cv.imread(&#34;img/3.jpg&#34;)
def img_show(src):
    ch=np.random.rand()*100
    cv.namedWindow(&#34;图片&#34;, cv.WINDOW_AUTOSIZE)
    cv.imshow(&#34;图片&#34;, src)
    cv.waitKey(0)
    cv.destroyAllWindows()
def img_process(src):
    #三通道均值：蓝，绿，红
    r_aver=217
    g_aver=110
    b_aver=78
    for i in range(len(src)):
        for j in range(len(src[i])):
            b_p=src[i][j][0]/sum(src[i][j])#b=b/(R+B+G)
            g_p=src[i][j][1]/sum(src[i][j])
            r_p = src[i][j][2] / sum(src[i][j])
            if src[i][j][2]&gt;r_aver and src[i][j][2]&gt;src[i][j][1]&gt;src[i][j][0] :
                if r_p&gt;=1.14*g_p-0.076 and r_p&lt;=-0.989*g_p+0.991 and             r_p&gt;=-2.077*g_p+1.025:
                    if r_p&lt;=-1.881*b_p+0.9582 and r_p&lt;=95.348*b_p+0.171 and r_p&gt;=-0.543*b_p+0.506:
                        if g_p&gt;=0.846*b_p+0.048 and g_p&lt;=-0.461*b_p+0.495 and g_p&lt;=191.957*b_p-0.621:
                            src[i][j][0] = 0
                            src[i][j][1] = 255
                            src[i][j][2] = 0
    return src
new_image=img_process(src)
img_show(new_image)

</code></pre>


      </google-codelab-step>
    
      <google-codelab-step label="参考文献" duration="0">
        <p>[1]耿庆田,于繁华,赵宏伟,王闯.基于颜色特征的火焰检测新算法[J].吉林大学学报(工学版),2014,44(06):1787-1792.</p>


      </google-codelab-step>
    
  </google-codelab>

  <script src="https://storage.googleapis.com/codelab-elements/native-shim.js"></script>
  <script src="https://storage.googleapis.com/codelab-elements/custom-elements.min.js"></script>
  <script src="https://storage.googleapis.com/codelab-elements/prettify.js"></script>
  <script src="https://storage.googleapis.com/codelab-elements/codelab-elements.js"></script>

</body>
</html>
